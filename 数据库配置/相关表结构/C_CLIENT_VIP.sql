/*
 Navicat Premium Dump SQL

 Source Server         : Bos
 Source Server Type    : Oracle
 Source Server Version : 110200 (Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options)
 Source Host           : 10.14.10.83:8853
 Source Schema         : BOSNDS3

 Target Server Type    : Oracle
 Target Server Version : 110200 (Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options)
 File Encoding         : 65001

 Date: 13/11/2025 14:17:04
*/


-- ----------------------------
-- Table structure for C_CLIENT_VIP
-- ----------------------------
DROP TABLE "BOSNDS3"."C_CLIENT_VIP";
CREATE TABLE "BOSNDS3"."C_CLIENT_VIP" (
  "ID" NUMBER(10,0) NOT NULL,
  "AD_CLIENT_ID" NUMBER(10,0),
  "AD_ORG_ID" NUMBER(10,0),
  "ISACTIVE" CHAR(1 BYTE) DEFAULT 'Y',
  "MODIFIERID" NUMBER(10,0),
  "CREATIONDATE" DATE,
  "MODIFIEDDATE" DATE,
  "OWNERID" NUMBER(10,0),
  "CARDNO" VARCHAR2(20 BYTE),
  "C_VIPTYPE_ID" NUMBER(10,0) NOT NULL,
  "IDNO" VARCHAR2(20 BYTE),
  "VIPNAME" VARCHAR2(20 BYTE),
  "VIPENAME" VARCHAR2(20 BYTE),
  "SEX" CHAR(1 BYTE) NOT NULL,
  "BIRTHDAY" NUMBER(8,0),
  "VALIDDATE" NUMBER(8,0),
  "CREDITREMAIN" NUMBER(16,4) DEFAULT 0,
  "COUNTRY" VARCHAR2(20 BYTE),
  "C_CITY_ID" NUMBER(10,0),
  "ADDRESS" VARCHAR2(200 BYTE),
  "POST" VARCHAR2(100 BYTE),
  "PHONE" VARCHAR2(100 BYTE),
  "MOBIL" VARCHAR2(100 BYTE),
  "EMAIL" VARCHAR2(100 BYTE),
  "VIPSTATE" CHAR(1 BYTE) DEFAULT 'Y',
  "C_STORE_ID" NUMBER(10,0),
  "C_CUSTOMER_ID" NUMBER(10,0),
  "C_CUSTOMERUP_ID" NUMBER(10,0),
  "INTEGRAL" NUMBER(16,0) DEFAULT 0,
  "ENTERDATE" NUMBER(8,0),
  "PASS_WORD" VARCHAR2(20 BYTE),
  "M_RETAILNO" VARCHAR2(200 BYTE),
  "BEST_TIME" VARCHAR2(255 BYTE),
  "BUILDING" VARCHAR2(255 BYTE),
  "VIPNO" VARCHAR2(100 BYTE),
  "STORECARDNO" VARCHAR2(20 BYTE),
  "M_RETAIL_ID" NUMBER(10,0),
  "C_OLDVIP_ID" NUMBER(10,0),
  "ENTERTYPE" CHAR(3 BYTE) DEFAULT 'NEW',
  "C_OLDVIP" VARCHAR2(80 BYTE),
  "SALER" VARCHAR2(80 BYTE),
  "OPENCARD_STATUS" NUMBER(1,0) DEFAULT 1,
  "OPENCARDERID" NUMBER(10,0),
  "OPENCARDTIME" DATE,
  "DESCRIPTION" VARCHAR2(255 BYTE),
  "DESCRIPTION2" VARCHAR2(255 BYTE),
  "OLDSTORE" VARCHAR2(500 BYTE),
  "C_SERVICEAREA_ID" NUMBER(10,0),
  "INTEGRAL_UP" NUMBER(16,0) DEFAULT 0,
  "AGE" NUMBER(10,0),
  "OPENCARDDATE" NUMBER(8,0),
  "C_OPENCARDTYPE_ID" NUMBER(10,0),
  "BABYNAME" VARCHAR2(255 BYTE),
  "ISUP" CHAR(1 BYTE) DEFAULT 'N',
  "ISOFF" CHAR(1 BYTE) DEFAULT 'N',
  "DATEUP" NUMBER(8,0),
  "DATEOFF" NUMBER(8,0),
  "LM_CARD" VARCHAR2(100 BYTE),
  "IMAGEURL" VARCHAR2(500 BYTE),
  "HR_EMPLOYEE_ID" NUMBER(10,0),
  "RETAIL_FILTER" CLOB,
  "PREBIRTHDATE" NUMBER(8,0),
  "ISPRECLIENT" CHAR(1 BYTE) DEFAULT 'Y',
  "ISPREPARENTS" CHAR(1 BYTE) DEFAULT 'Y',
  "BABYIDNO" VARCHAR2(20 BYTE),
  "PARENTSPOSITION" VARCHAR2(80 BYTE),
  "PARENTSPROFESSIONAL" VARCHAR2(80 BYTE),
  "MICROACCOUNT" VARCHAR2(255 BYTE),
  "BABYBIRTH" NUMBER(8,0),
  "SEX2" CHAR(1 BYTE),
  "EDUCATION" VARCHAR2(20 BYTE),
  "HMONINCOME" VARCHAR2(20 BYTE),
  "INT_CH_GIFT" VARCHAR2(80 BYTE),
  "WHEN_COME" VARCHAR2(80 BYTE),
  "INF_SOURCE" VARCHAR2(80 BYTE),
  "LINKSTYLES" VARCHAR2(20 BYTE),
  "S_BABYNAME" VARCHAR2(255 BYTE),
  "ISEXPIRED" CHAR(1 BYTE) DEFAULT 'N',
  "MARITAL" VARCHAR2(1 BYTE),
  "HOMETOWN" VARCHAR2(255 BYTE),
  "MSNQQ" VARCHAR2(255 BYTE),
  "WEIBO" VARCHAR2(255 BYTE),
  "HOMEADDRESS" VARCHAR2(255 BYTE),
  "COMPANYNAME" VARCHAR2(255 BYTE),
  "COMPANYADDRESS" VARCHAR2(255 BYTE),
  "JOB" VARCHAR2(255 BYTE),
  "POSITION" VARCHAR2(255 BYTE),
  "MONTHINCOME" NUMBER(10,0),
  "C_INTEGRALAREA_ID" NUMBER(10,0),
  "LASTTIME" DATE,
  "IS_FIRST_INTER" CHAR(1 BYTE) DEFAULT 'N',
  "OPENID" VARCHAR2(200 BYTE),
  "CARDID" VARCHAR2(200 BYTE),
  "WSHNO" VARCHAR2(200 BYTE),
  "NAME" VARCHAR2(200 BYTE),
  "IS_PASSWORD_CHECK" CHAR(1 BYTE) DEFAULT 'N',
  "INTL_STATUS" CHAR(1 BYTE) DEFAULT 'N',
  "M_DIM1_ID" NUMBER(10,0),
  "INTEGRAL_PASSWORD" NUMBER(4,0),
  "C_CONSUMEAREA_ID" NUMBER(10,0),
  "DATECLEAR" NUMBER(8,0),
  "CHECKCODE" CHAR(4 BYTE),
  "CREATEDATE" DATE,
  "CHECKCODE_Q" CHAR(4 BYTE),
  "CREATECODEDATE_Q" DATE,
  "IS_BOUND" CHAR(1 BYTE),
  "CHECKCODE_J" CHAR(4 BYTE),
  "CREATECODEDATE_J" DATE,
  "EXPIRE_INTEGRAL" NUMBER(16,0) DEFAULT 0,
  "EXPIRE_DATE" NUMBER(8,0),
  "C_PROVINCE_ID" NUMBER(10,0),
  "C_MEMSTORE_ID" NUMBER(10,0),
  "WECHAT_UNION_ID" VARCHAR2(255 BYTE),
  "MINIAPP_OPEN_ID" VARCHAR2(255 BYTE),
  "PREVIOUS_ID" NUMBER(10,0),
  "SR" NUMBER(8,0),
  "IS_OWN_TICKET" CHAR(1 BYTE) DEFAULT 'Y',
  "WID" NUMBER(10,0),
  "C_VIPTYPE_OLD" NUMBER(10,0),
  "MID" NUMBER(10,0),
  "WID_DATE" DATE,
  "WPNO" VARCHAR2(100 BYTE),
  "OLDC_STORE_ID" VARCHAR2(100 BYTE),
  "VIP_STATUS" CHAR(1 BYTE) DEFAULT '1'
)
LOGGING
NOCOMPRESS
PCTFREE 10
INITRANS 1
STORAGE (
  INITIAL 1048576 
  NEXT 8192 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  BUFFER_POOL DEFAULT
)
PARALLEL 1
NOCACHE
DISABLE ROW MOVEMENT
;
COMMENT ON COLUMN "BOSNDS3"."C_CLIENT_VIP"."CHECKCODE" IS '校验码';
COMMENT ON COLUMN "BOSNDS3"."C_CLIENT_VIP"."CREATEDATE" IS '生成时间';
COMMENT ON COLUMN "BOSNDS3"."C_CLIENT_VIP"."CHECKCODE_Q" IS '校验码';
COMMENT ON COLUMN "BOSNDS3"."C_CLIENT_VIP"."CREATECODEDATE_Q" IS '生成时间';
COMMENT ON COLUMN "BOSNDS3"."C_CLIENT_VIP"."WPNO" IS '微盟同步手机号';

-- ----------------------------
-- Primary Key structure for table C_CLIENT_VIP
-- ----------------------------
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "PK_C_CLIENT_VIP" PRIMARY KEY ("ID");

-- ----------------------------
-- Uniques structure for table C_CLIENT_VIP
-- ----------------------------
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "WPNO_UNIQUE" UNIQUE ("WPNO") NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Checks structure for table C_CLIENT_VIP
-- ----------------------------
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "SYS_C0025529" CHECK ("ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "SYS_C0025530" CHECK ("C_VIPTYPE_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "SYS_C0025531" CHECK ("SEX" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Indexes structure for table C_CLIENT_VIP
-- ----------------------------
CREATE UNIQUE INDEX "BOSNDS3"."IDXVIPCARDNO"
  ON "BOSNDS3"."C_CLIENT_VIP" ("CARDNO" ASC)
  LOGGING
  VISIBLE
PCTFREE 10
INITRANS 2
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  BUFFER_POOL DEFAULT
);
CREATE INDEX "BOSNDS3"."IDXVIPCLINET"
  ON "BOSNDS3"."C_CLIENT_VIP" ("MOBIL" ASC)
  LOGGING
  VISIBLE
PCTFREE 10
INITRANS 2
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  BUFFER_POOL DEFAULT
);
CREATE INDEX "BOSNDS3"."IDXVIPVIPTYPE"
  ON "BOSNDS3"."C_CLIENT_VIP" ("C_VIPTYPE_ID" ASC)
  LOGGING
  VISIBLE
PCTFREE 10
INITRANS 2
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  BUFFER_POOL DEFAULT
);
CREATE INDEX "BOSNDS3"."IDX_C_CLIENT_VIP_01"
  ON "BOSNDS3"."C_CLIENT_VIP" ("WID" ASC)
  LOGGING
  VISIBLE
PCTFREE 10
INITRANS 2
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  BUFFER_POOL DEFAULT
);

-- ----------------------------
-- Triggers structure for table C_CLIENT_VIP
-- ----------------------------
CREATE TRIGGER "BOSNDS3"."BI_C_CLIENT_VIP" AFTER UPDATE ON "BOSNDS3"."C_CLIENT_VIP" REFERENCING OLD AS "OLD" NEW AS "NEW" FOR EACH ROW 
BEGIN
    IF UPDATING THEN
        /*
           [VIP卡号]修改前和修改后的值不同、或者[VIP类型]修改前和修改后的值不同则写入表[C_CLIENT_VIP_LOG]。
          注意:表[VIP修改日志]的字段[修改人、修改时间]取[VIP档案]的[修改人、修改时间]。
        */
        IF (:NEW.CARDNO <> :OLD.CARDNO) OR
           (:OLD.C_VIPTYPE_ID <> :NEW.C_VIPTYPE_ID) THEN
        
            INSERT INTO c_client_vip_log
                (ID, AD_CLIENT_ID, AD_ORG_ID, OLD_CARDNO, NEW_CARDNO,
                 C_OLDVIPTYPE_ID, C_NEWVIPTYPE_ID, C_VIP_ID, OWNERID, MODIFIERID,
                 CREATIONDATE, MODIFIEDDATE, ISACTIVE)
            VALUES
                (get_sequences('c_client_vip_log'), :NEW.ad_client_id,
                 :NEW.ad_org_id, :OLD.cardno, :NEW.cardno, :OLD.C_VIPTYPE_ID,
                 :NEW.C_VIPTYPE_ID, :NEW.ID, :NEW.ownerid,
                 :NEW.modifierid, SYSDATE, :NEW.MODIFIEDDATE, :NEW.isactive);
        END IF;
    END IF;

END BI_C_CLIENT_VIP;
/

-- ----------------------------
-- Foreign Keys structure for table C_CLIENT_VIP
-- ----------------------------
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "FK_C_CLIENT_REFERENCE_C_CITY" FOREIGN KEY ("C_CITY_ID") REFERENCES "BOSNDS3"."C_CITY" ("ID") ON DELETE SET NULL NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "FK_C_CLIENT_VIP_1" FOREIGN KEY ("C_CONSUMEAREA_ID") REFERENCES "BOSNDS3"."C_CONSUMEAREA" ("ID") NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "FK_C_CLIENT_VIP_63322" FOREIGN KEY ("C_SERVICEAREA_ID") REFERENCES "BOSNDS3"."C_SERVICEAREA" ("ID") ON DELETE SET NULL NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "FK_C_OPENCARDTYPE" FOREIGN KEY ("C_OPENCARDTYPE_ID") REFERENCES "BOSNDS3"."C_OPENCARDTYPE" ("ID") ON DELETE SET NULL NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "FK_HR_EMPLOYEE" FOREIGN KEY ("HR_EMPLOYEE_ID") REFERENCES "BOSNDS3"."HR_EMPLOYEE" ("ID") ON DELETE SET NULL NOT DEFERRABLE INITIALLY IMMEDIATE NORELY DISABLE NOVALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "FK_M_RETAIL_ID" FOREIGN KEY ("M_RETAIL_ID") REFERENCES "BOSNDS3"."M_RETAIL" ("ID") ON DELETE SET NULL NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "BOSNDS3"."C_CLIENT_VIP" ADD CONSTRAINT "FK_VIP_REFERENCE_VIPTYPE" FOREIGN KEY ("C_VIPTYPE_ID") REFERENCES "BOSNDS3"."C_VIPTYPE" ("ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY DISABLE NOVALIDATE;
